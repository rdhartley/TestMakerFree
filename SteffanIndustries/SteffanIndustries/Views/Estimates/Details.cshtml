@model SteffanIndustries.Models.Estimate

@{
    ViewData["Title"] = "Details";
}
<h2>Estimate Details</h2>

<div>
    <h4>Estimate</h4>
    <hr />
    <dl class="dl-horizontal">
        <dt>
            @Html.DisplayNameFor(model => model.EstimateDate)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.EstimateDate)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.JobName)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.JobName)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Scope)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Scope)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Contact)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Contact)
        </dd>
        <dd>
            <table class="display" id="myEstimateDetailDataTable">
                <thead>
                    <tr>
                    <th>Category</th>
                    <th>Description</th>
                    <th>Rate</th>
                    <th>UOM</th>
                    <th>Qty</th>
                    <th>Workers</th>
                    @*<th>Hours</th>*@
                    <th>Days</th>
                    @*<th>Cost</th>*@
                    <th>Markup</th>
                    <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.EstimateDetail)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => item.Category)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Description)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Rate)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.UOM)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.UOMQuantity)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.NumberOfWorkers)
                            </td>
                            @*<td>
                        @Html.DisplayFor(modelItem => item.NumberOfHours)
                    </td>*@
                            <td>
                                @Html.DisplayFor(modelItem => item.NumberOfDays)
                            </td>
                            @*<td>
                        @Html.DisplayFor(modelItem => item.Cost)
                    </td>*@
                            <td>
                                @Html.DisplayFor(modelItem => item.Markup)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.TotalAmount)
                            </td>
                        </tr>
                    }
                    </tbody>
                <tfoot>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                </tfoot>
</table>
        </dd>
    </dl>
</div>
<div>
    <a asp-action="Edit" asp-route-id="@Model.EstimateID">Edit</a> |
    <a asp-action="Index">Back to List</a>
</div>
@section Scripts {

    <script language="javascript" type="text/javascript">
        $(document).ready(function () {
            $('#myEstimateDetailDataTable').dataTable({
                "bSort": false,
                "searching": false,
                fixedHeader: {
                    header: false,
                    footer: true
                },
                "paging": false,
                "footerCallback": function (tfoot, data, start, end, display) {
                    var api = this.api();
                    var intVal = function (i) {
                        return typeof i === 'string' ?
                            i.replace(/[\$,]/g, '') * 1 :
                            typeof i === 'number' ?
                                i : 0;
                    };
                    total = api
                        .column(8)
                        .data()
                        .reduce(function (a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);
    
                    var numFormat = $.fn.dataTable.render.number('\,', '.', 2, '$').display;
                    $(api.column(8).footer()).html(numFormat(total));

                },
                "columnDefs": [
                    { className: "dt-right", "targets": [2, 8] }
                ]
            });
        });
    </script>
}